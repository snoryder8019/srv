<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link rel="stylesheet" href="/stylesheets/style.css">
  <link rel="stylesheet" href="/stylesheets/landing.css">
  <link rel="stylesheet" href="/stylesheets/menu-enhanced.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body class="landing-page menu-page">
  <%- include('partials/header', { user: user }) %>

  <!-- Stars Background -->
  <div class="stars-background"></div>

  <main class="menu-container">
    <!-- Menu Header -->
    <div class="menu-header">
      <div class="menu-badge">
        <span class="badge-glow">ğŸ®</span>
        <span>Command Center</span>
      </div>
      <h1 class="menu-title">
        <span class="gradient-text">Main Menu</span>
      </h1>
      <p class="menu-subtitle">
        Welcome to the Stringborn Universe - Your gateway to infinite possibilities
      </p>
    </div>

    <!-- Menu Grid -->
    <div class="menu-grid">
      <!-- Game Features Section -->
      <div class="menu-section">
        <h2 class="section-heading">
          <span class="section-icon">ğŸŒŒ</span>
          <span>Game Features</span>
        </h2>
        <div class="menu-items">
          <a href="/universe/galactic-map" class="menu-card featured">
            <div class="card-glow"></div>
            <div class="menu-card-icon">ğŸ—ºï¸</div>
            <h3>Galactic Territory Map</h3>
            <p>Interactive 2D map of faction territories and real-time character tracking</p>
            <div class="card-badge">Featured</div>
          </a>

          <a href="/universe/tome" class="menu-card">
            <div class="menu-card-icon">ğŸ“–</div>
            <h3>The Tome</h3>
            <p>Story, characters, monsters, and species archive</p>
          </a>

          <a href="/universe/galactic-state" class="menu-card">
            <div class="menu-card-icon">â­</div>
            <h3>Galactic State</h3>
            <p>View the current state of the living universe</p>
          </a>

          <a href="/zones" class="menu-card">
            <div class="menu-card-icon">ğŸŒ</div>
            <h3>Explore Zones</h3>
            <p>Browse all discovery and spatial zones</p>
          </a>
        </div>
      </div>

      <% if (user) { %>
        <!-- User Features Section -->
        <div class="menu-section">
          <h2 class="section-heading">
            <span class="section-icon">ğŸ‘¤</span>
            <span>My Content</span>
          </h2>
          <div class="menu-items">
            <a href="/profile" class="menu-card featured">
              <div class="card-glow"></div>
              <div class="menu-card-icon">ğŸ“Š</div>
              <h3>My Profile</h3>
              <p>View your stats, achievements, and activity</p>
              <div class="card-badge">You</div>
            </a>

            <a href="/characters" class="menu-card">
              <div class="menu-card-icon">âš”ï¸</div>
              <h3>My Characters</h3>
              <p>View and manage your characters with talents and equipment</p>
            </a>

            <a href="/assets" class="menu-card featured">
              <div class="card-glow"></div>
              <div class="menu-card-icon">ğŸ¨</div>
              <h3>Asset Builder</h3>
              <p>Create game assets with built-in pixel editor</p>
              <div class="card-badge">Create</div>
            </a>

            <a href="/assets/my-assets" class="menu-card">
              <div class="menu-card-icon">ğŸ“¦</div>
              <h3>My Assets</h3>
              <p>Manage your assets and review community suggestions</p>
            </a>
          </div>
        </div>
      <% } %>

      <!-- Community Features Section -->
      <div class="menu-section">
        <h2 class="section-heading">
          <span class="section-icon">ğŸŒŸ</span>
          <span>Community</span>
        </h2>
        <div class="menu-items">
          <a href="/assets/voting" class="menu-card featured">
            <div class="card-glow"></div>
            <div class="menu-card-icon">ğŸ—³ï¸</div>
            <h3>Community Voting</h3>
            <p>Vote for your favorite community-created assets</p>
            <div class="card-badge">Popular</div>
          </a>

          <% if (!user) { %>
            <a href="/auth" class="menu-card highlight">
              <div class="menu-card-icon">ğŸ”</div>
              <h3>Login / Register</h3>
              <p>Join the community and start creating</p>
            </a>
          <% } %>
        </div>
      </div>

      <% if (user && user.isAdmin) { %>
        <!-- Admin Features Section -->
        <div class="menu-section admin-section">
          <h2 class="section-heading">
            <span class="section-icon">âš™ï¸</span>
            <span>Administration</span>
          </h2>
          <div class="menu-items">
            <a href="/admin" class="menu-card admin featured">
              <div class="card-glow"></div>
              <div class="menu-card-icon">ğŸ“Š</div>
              <h3>Analytics Dashboard</h3>
              <p>View platform analytics and insights</p>
              <div class="card-badge">Admin</div>
            </a>

            <a href="/admin/users" class="menu-card admin">
              <div class="menu-card-icon">ğŸ‘¥</div>
              <h3>User Management</h3>
              <p>Manage users and view user analytics</p>
            </a>

            <a href="/admin/assets" class="menu-card admin">
              <div class="menu-card-icon">âœ…</div>
              <h3>Asset Approvals</h3>
              <p>Approve or reject community assets</p>
            </a>

            <a href="/admin/game-state" class="menu-card admin">
              <div class="menu-card-icon">ğŸ®</div>
              <h3>Game State Controls</h3>
              <p>Configure galactic simulation parameters</p>
            </a>

            <a href="/admin/galactic-map-settings" class="menu-card admin">
              <div class="menu-card-icon">ğŸŒŒ</div>
              <h3>Galactic Map Settings</h3>
              <p>Control movement speed and grid size</p>
            </a>

            <a href="/admin/generate" class="menu-card admin">
              <div class="menu-card-icon">ğŸ”§</div>
              <h3>Generate Assets</h3>
              <p>Create system assets and configurations</p>
            </a>
          </div>
        </div>
      <% } %>
    </div>

    <!-- Background Orbs -->
    <div class="menu-background">
      <div class="orb orb-1"></div>
      <div class="orb orb-2"></div>
      <div class="orb orb-3"></div>
    </div>
  </main>

  <%- include('partials/footer') %>
  <script src="/javascripts/landing.js"></script>
  <script>
    // Update galactic map link with character from localStorage
    document.addEventListener('DOMContentLoaded', () => {
      const selectedCharacterId = localStorage.getItem('selectedCharacterId');

      if (selectedCharacterId) {
        // Find all galactic map links and add character parameter
        const galacticMapLinks = document.querySelectorAll('a[href="/universe/galactic-map"]');
        galacticMapLinks.forEach(link => {
          link.href = `/universe/galactic-map?character=${selectedCharacterId}`;
        });

        console.log('Updated galactic map links with character:', selectedCharacterId);
      }
    });
  </script>
</body>
</html>
