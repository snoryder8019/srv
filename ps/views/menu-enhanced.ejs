<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link rel="stylesheet" href="/stylesheets/style.css">
  <link rel="stylesheet" href="/stylesheets/landing.css">
  <link rel="stylesheet" href="/stylesheets/menu-enhanced.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body class="landing-page menu-page">
  <%- include('partials/header', { user: user }) %>

  <!-- Stars Background -->
  <div class="stars-background"></div>

  <main class="menu-container">
    <!-- Menu Header -->
    <div class="menu-header">
      <div class="menu-badge">
        <span class="badge-glow">âš¡</span>
        <span>System Access</span>
      </div>
      <h1 class="menu-title">
        <span class="gradient-text">Navigation Hub</span>
      </h1>
      <p class="menu-subtitle">
        Distributed MMO infrastructure with community-governed development
      </p>
    </div>

    <!-- Menu Grid -->
    <div class="menu-grid">
      <!-- Core Systems -->
      <div class="menu-section">
        <h2 class="section-heading">
          <span class="section-icon">ğŸŒŒ</span>
          <span>Core Systems</span>
        </h2>
        <div class="menu-items">
          <a href="/characters" class="menu-card featured">
            <div class="card-glow"></div>
            <div class="menu-card-icon">ğŸ®</div>
            <h3>Enter Game</h3>
            <p>Select your character and enter the persistent universe</p>
            <div class="card-badge">Live</div>
          </a>

          <a href="/universe/tome" class="menu-card">
            <div class="menu-card-icon">ğŸ“–</div>
            <h3>Lore Database</h3>
            <p>Canonical entity registry for species, characters, and environmental assets</p>
          </a>

          <a href="/universe/galactic-state" class="menu-card">
            <div class="menu-card-icon">â­</div>
            <h3>Universe State Monitor</h3>
            <p>Synchronized view of persistent world simulation parameters</p>
          </a>
        </div>
      </div>

      <% if (user) { %>
        <!-- Player Dashboard -->
        <div class="menu-section">
          <h2 class="section-heading">
            <span class="section-icon">ğŸ‘¤</span>
            <span>Player Dashboard</span>
          </h2>
          <div class="menu-items">
            <a href="/profile" class="menu-card featured">
              <div class="card-glow"></div>
              <div class="menu-card-icon">ğŸ‘¤</div>
              <h3>Profile</h3>
              <p>Performance analytics, achievement unlocks, and activity timeline</p>
              <div class="card-badge">Stats</div>
            </a>

            <a href="/characters" class="menu-card">
              <div class="menu-card-icon">âš”ï¸</div>
              <h3>Character Registry</h3>
              <p>Manage entities with talent trees, equipment loadouts, and progression paths</p>
            </a>

            <a href="/assets" class="menu-card featured">
              <div class="card-glow"></div>
              <div class="menu-card-icon">ğŸ¨</div>
              <h3>Asset Workshop</h3>
              <p>Integrated pixel editor for sprite creation and environment design</p>
              <div class="card-badge">Build</div>
            </a>

            <a href="/universe/sprite-creator" class="menu-card featured">
              <div class="card-glow"></div>
              <div class="menu-card-icon">ğŸŒ</div>
              <h3>World Sprite Builder</h3>
              <p>Create 2D sprite atlases for planets, terrain, monsters with integrated pixel editor</p>
              <div class="card-badge">New</div>
            </a>

            <a href="/universe/ship-builder" class="menu-card featured">
              <div class="card-glow"></div>
              <div class="menu-card-icon">ğŸš€</div>
              <h3>Universal Ship Builder</h3>
              <p>Design custom starships with modular components, weapons, and visual editing</p>
              <div class="card-badge">New</div>
            </a>

            <a href="/assets/my-assets" class="menu-card">
              <div class="menu-card-icon">ğŸ“¦</div>
              <h3>My Assets</h3>
              <p>Review submitted assets and track community feedback metrics</p>
            </a>
          </div>
        </div>
      <% } %>

      <!-- Governance Layer -->
      <div class="menu-section">
        <h2 class="section-heading">
          <span class="section-icon">ğŸŒŸ</span>
          <span>Governance</span>
        </h2>
        <div class="menu-items">
          <a href="/assets/voting" class="menu-card featured">
            <div class="card-glow"></div>
            <div class="menu-card-icon">ğŸ—³ï¸</div>
            <h3>Asset Governance</h3>
            <p>Democratic approval protocol for player-submitted content integration</p>
            <div class="card-badge">Active</div>
          </a>

          <% if (!user) { %>
            <a href="/auth" class="menu-card highlight">
              <div class="menu-card-icon">ğŸ”</div>
              <h3>Authentication Portal</h3>
              <p>Register account to participate in content creation and governance</p>
            </a>
          <% } %>
        </div>
      </div>

      <!-- Updates & Information -->
      <div class="menu-section">
        <h2 class="section-heading">
          <span class="section-icon">ğŸ“°</span>
          <span>Updates & Information</span>
        </h2>
        <div class="menu-items">
          <a href="/help/developer-letter" class="menu-card featured">
            <div class="card-glow"></div>
            <div class="menu-card-icon">âœ‰ï¸</div>
            <h3>Developer Letter</h3>
            <p>Vision, roadmap, and insights from the development team</p>
            <div class="card-badge">v0.4</div>
          </a>

          <a href="/help/patch-notes" class="menu-card">
            <div class="menu-card-icon">ğŸ“‹</div>
            <h3>Patch Notes</h3>
            <p>Complete changelog with features, fixes, and technical improvements</p>
          </a>

          <a href="/help/documentation" class="menu-card featured">
            <div class="card-glow"></div>
            <div class="menu-card-icon">ğŸ“š</div>
            <h3>Documentation</h3>
            <p>Complete system guides, API references, and technical documentation</p>
            <div class="card-badge">Docs</div>
          </a>
        </div>
      </div>

      <% if (user && user.isAdmin) { %>
        <!-- System Administration -->
        <div class="menu-section admin-section">
          <h2 class="section-heading">
            <span class="section-icon">âš™ï¸</span>
            <span>System Administration</span>
          </h2>
          <div class="menu-items">
            <a href="/admin" class="menu-card admin featured">
              <div class="card-glow"></div>
              <div class="menu-card-icon">ğŸ“Š</div>
              <h3>Telemetry Console</h3>
              <p>User behavior analytics, engagement metrics, and growth tracking</p>
              <div class="card-badge">Admin</div>
            </a>

            <a href="/admin/users" class="menu-card admin">
              <div class="menu-card-icon">ğŸ‘¥</div>
              <h3>User Administration</h3>
              <p>Account management, permissions, and activity monitoring</p>
            </a>

            <a href="/admin/assets" class="menu-card admin">
              <div class="menu-card-icon">âœ…</div>
              <h3>Content Moderation</h3>
              <p>Review queue for player-submitted asset approval workflow</p>
            </a>

            <a href="/admin/game-state" class="menu-card admin">
              <div class="menu-card-icon">ğŸ®</div>
              <h3>Simulation Controls</h3>
              <p>Runtime parameter tuning for universe state machine</p>
            </a>

            <a href="/admin/galactic-map-settings" class="menu-card admin">
              <div class="menu-card-icon">ğŸŒŒ</div>
              <h3>Map Configuration</h3>
              <p>Adjust traversal velocity, grid resolution, and render distance</p>
            </a>

            <a href="/admin/generate" class="menu-card admin">
              <div class="menu-card-icon">ğŸ”§</div>
              <h3>Asset Generator</h3>
              <p>Procedural entity creation tools and batch configuration</p>
            </a>

            <a href="/admin/live-dashboard" class="menu-card admin featured">
              <div class="card-glow"></div>
              <div class="menu-card-icon">âš¡</div>
              <h3>Live Dashboard</h3>
              <p>Real-time system monitoring, test runner, and service health checks</p>
              <div class="card-badge">NEW</div>
            </a>

            <a href="/admin/control-panel" class="menu-card admin">
              <div class="menu-card-icon">âš™ï¸</div>
              <h3>Script Control Panel</h3>
              <p>Execute utility scripts and manage automated maintenance tasks</p>
            </a>
          </div>
        </div>
      <% } %>
    </div>

    <!-- Background Orbs -->
    <div class="menu-background">
      <div class="orb orb-1"></div>
      <div class="orb orb-2"></div>
      <div class="orb orb-3"></div>
    </div>
  </main>

  <%- include('partials/footer') %>
  <script src="/javascripts/landing.js"></script>
  <script>
    // Update galactic map link with character from localStorage
    document.addEventListener('DOMContentLoaded', () => {
      const selectedCharacterId = localStorage.getItem('selectedCharacterId');

      if (selectedCharacterId) {
        // Find all galactic map links and add character parameter
        const galacticMapLinks = document.querySelectorAll('a[href="/universe/galactic-map"]');
        galacticMapLinks.forEach(link => {
          link.href = `/universe/galactic-map?character=${selectedCharacterId}`;
        });

        console.log('Updated galactic map links with character:', selectedCharacterId);
      }
    });
  </script>
</body>
</html>
