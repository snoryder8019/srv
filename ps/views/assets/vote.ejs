<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Community Voting</title>
  <link rel="stylesheet" href="/stylesheets/style.css">
  <link rel="stylesheet" href="/stylesheets/asset-builder.css">
</head>
<body>
  <%- include('../partials/header', { user: user, character: character }) %>

  <div class="voting-container">
    <div class="voting-header">
      <h1>Community Voting</h1>
      <p>Vote for your favorite community-created assets!</p>
      <% if (user) { %>
        <p style="color: #10b981;">‚úì Logged in as: <%= user.username %></p>
      <% } else { %>
        <p style="color: #ef4444;">Please <a href="/auth">login</a> to vote</p>
      <% } %>
    </div>

    <!-- Category Filter: In Development vs Live -->
    <div class="voting-filters" style="margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 2px solid #e5e7eb;">
      <h3 style="margin: 0 0 0.75rem 0; font-size: 0.875rem; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px;">Category</h3>
      <button class="filter-btn status-filter active" data-status="submitted">üöß In Development</button>
      <button class="filter-btn status-filter" data-status="approved">‚úÖ Live</button>
      <% if (user && user.isAdmin) { %>
        <button class="filter-btn status-filter" data-status="all">All</button>
      <% } %>
    </div>

    <!-- Type Filter -->
    <div class="voting-filters">
      <h3 style="margin: 0 0 0.75rem 0; font-size: 0.875rem; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px;">Asset Type</h3>
      <select id="assetTypeFilter" class="type-filter-dropdown" style="width: 100%; padding: 0.75rem; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 1rem; background: white; cursor: pointer; transition: all 0.2s;">
        <option value="all">All Types</option>
        <option value="character">Character/NPC</option>
        <option value="item">Item</option>
        <option value="weapon">Weapon</option>
        <option value="armor">Armor</option>
        <option value="ship">Ship/Vehicle</option>
        <option value="module">Ship Module</option>
        <option value="ammo">Ammunition</option>
        <option value="consumable">Consumable</option>
        <option value="planet">üåç Planet</option>
        <option value="orbital">üõ∞Ô∏è Orbital Station</option>
        <option value="environment">Environment/Zone</option>
        <option value="object">Object (Pixel-Built)</option>
        <option value="structure">Structure/Building</option>
        <option value="quest">Quest/Mission</option>
        <option value="ability">Ability/Skill</option>
        <option value="species">Species</option>
        <option value="faction">Faction</option>
        <option value="galaxy">Galaxy</option>
        <option value="anomaly">Anomaly</option>
        <option value="zone">Zone</option>
        <option value="other">Other</option>
      </select>
    </div>

    <div id="alertContainer"></div>
    <div class="voting-grid" id="votingGrid">
      <p>Loading assets...</p>
    </div>
  </div>

  <%- include('../partials/footer') %>

  <!-- PASS USER DATA TO JAVASCRIPT -->
  <script>
    <% if (user) { %>
      window.USER_ID = "<%= user._id %>";
      window.USERNAME = "<%= user.username %>";
      window.IS_ADMIN = <%= user.isAdmin ? 'true' : 'false' %>;
    <% } else { %>
      window.USER_ID = null;
      window.USERNAME = null;
      window.IS_ADMIN = false;
    <% } %>
  </script>

  <!-- LOAD VOTING SCRIPT -->
  <script src="/javascripts/vote.js"></script>
  <script src="/javascripts/suggestions.js"></script>
</body>
</html>
