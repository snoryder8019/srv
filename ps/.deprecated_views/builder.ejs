<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link rel="stylesheet" href="/stylesheets/style.css">
  <link rel="stylesheet" href="/stylesheets/asset-builder.css">
</head>
<body>
  <%- include('../partials/header', { user: user }) %>

  <div class="asset-builder-container">
    <h1>Asset Builder</h1>
    <p>Create and submit your own game assets for community approval!</p>

    <div id="alertContainer"></div>

    <!-- Asset Builder Form -->
    <div class="asset-form" id="assetForm">
      <form id="builderForm" enctype="multipart/form-data">
        <!-- Basic Info -->
        <div class="form-section">
          <h3>Basic Information</h3>

          <div class="form-group">
            <label for="title">Asset Title *</label>
            <input type="text" id="title" name="title" required>
          </div>

          <div class="form-group">
            <label for="description">Description</label>
            <textarea id="description" name="description"></textarea>
          </div>

          <div class="form-group">
            <label for="assetType">Asset Type *</label>
            <select id="assetType" name="assetType" required>
              <option value="">Select Type</option>
              <option value="character">Character</option>
              <option value="environment">Environment</option>
              <option value="object">Object (Pixel-Built)</option>
              <option value="item">Item</option>
              <option value="species">Species</option>
              <option value="npc">NPC</option>
              <option value="other">Other</option>
            </select>
          </div>
        </div>

        <!-- Type-Specific Fields -->
        <div id="typeSpecificFields"></div>

        <!-- Pixel Editor -->
        <div class="form-section">
          <h3>Pixel Art Editor</h3>
          <p>Create pixel art for your asset using the editor below:</p>
          <div id="pixelEditorContainer"></div>
        </div>

        <!-- Image Uploads -->
        <div class="form-section">
          <h3>Image Uploads</h3>
          <p>Upload additional images for your asset (all images are optional):</p>

          <div class="file-upload-section">
            <!-- Pixel Art Upload -->
            <div class="file-upload-box">
              <h4>Pixel Art</h4>
              <p class="file-info">Alternative to pixel editor<br>Max 10MB</p>
              <input type="file" id="pixelArtFile" name="pixelArt" accept="image/*">
              <label for="pixelArtFile" class="file-upload-label">
                üìÅ Choose File
              </label>
              <div id="pixelArtPreview"></div>
            </div>

            <!-- Fullscreen Artwork -->
            <div class="file-upload-box">
              <h4>Fullscreen Artwork *</h4>
              <p class="file-info">Main display image<br>Max 10MB</p>
              <input type="file" id="fullscreenFile" name="fullscreen" accept="image/*" required>
              <label for="fullscreenFile" class="file-upload-label">
                üìÅ Choose File
              </label>
              <div id="fullscreenPreview"></div>
            </div>

            <!-- Index Card Artwork -->
            <div class="file-upload-box">
              <h4>Index Card *</h4>
              <p class="file-info">Thumbnail/card image<br>Max 10MB</p>
              <input type="file" id="indexCardFile" name="indexCard" accept="image/*" required>
              <label for="indexCardFile" class="file-upload-label">
                üìÅ Choose File
              </label>
              <div id="indexCardPreview"></div>
            </div>
          </div>
        </div>

        <!-- Form Actions -->
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" id="saveDraftBtn">
            Save as Draft
          </button>
          <button type="button" class="btn btn-success" id="submitBtn">
            Submit for Approval
          </button>
        </div>
      </form>
    </div>

    <!-- My Assets List -->
    <div class="form-section" style="margin-top: 3rem;">
      <h2>My Assets</h2>
      <div class="asset-list" id="assetList">
        <p>Loading...</p>
      </div>
    </div>
  </div>

  <%- include('../partials/footer') %>

  <script src="/javascripts/pixel-editor.js"></script>
  <script src="/javascripts/asset-builder.js"></script>
</body>
</html>
