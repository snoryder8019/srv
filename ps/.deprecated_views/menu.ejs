<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %></title>
  <link rel="stylesheet" href="/stylesheets/style.css">
  <link rel="stylesheet" href="/stylesheets/menu.css">
</head>
<body>
  <%- include('partials/header', { user: user }) %>

  <main class="container menu-container">
    <h1>Main Menu</h1>
    <p class="menu-subtitle">Welcome to the Stringborn Universe</p>

    <div class="menu-grid">
      <!-- Game Features -->
      <div class="menu-section">
        <h2>Game Features</h2>
        <div class="menu-items">
          <a href="/zones" class="menu-card">
            <div class="menu-card-icon">ğŸŒ</div>
            <h3>Explore Zones</h3>
          </a>

          <a href="/universe/tome" class="menu-card">
            <div class="menu-card-icon">ğŸ“–</div>
            <h3>The Tome</h3>
            <p>Story, characters, monsters, and species</p>
          </a>

          <a href="/universe/galactic-state" class="menu-card">
            <div class="menu-card-icon">â­</div>
            <h3>Galactic State</h3>
            <p>View the current state of the universe</p>
          </a>

          <a href="/universe/galactic-map" class="menu-card highlight">
            <div class="menu-card-icon">ğŸ—ºï¸</div>
            <h3>Galactic Territory Map</h3>
            <p>Interactive 2D map of faction territories</p>
          </a>
        </div>
      </div>

      <% if (user) { %>
        <!-- User Features -->
        <div class="menu-section">
          <h2>My Content</h2>
          <div class="menu-items">
            <a href="/profile" class="menu-card highlight">
              <div class="menu-card-icon">ğŸ‘¤</div>
              <h3>My Profile</h3>
              <p>View your stats and achievements</p>
            </a>

            <a href="/characters" class="menu-card">
              <div class="menu-card-icon">âš”ï¸</div>
              <h3>My Characters</h3>
              <p>View and manage your characters</p>
            </a>

            <a href="/assets" class="menu-card highlight">
              <div class="menu-card-icon">ğŸ¨</div>
              <h3>Asset Builder</h3>
              <p>Create game assets with pixel editor</p>
            </a>

            <a href="/assets/my-assets" class="menu-card">
              <div class="menu-card-icon">ğŸ“¦</div>
              <h3>My Assets</h3>
              <p>Manage your assets and review suggestions</p>
            </a>
          </div>
        </div>
      <% } %>

      <!-- Community Features -->
      <div class="menu-section">
        <h2>Community</h2>
        <div class="menu-items">
          <a href="/assets/voting" class="menu-card highlight">
            <div class="menu-card-icon">ğŸ—³ï¸</div>
            <h3>Community Voting</h3>
            <p>Vote for your favorite community assets</p>
          </a>

          <% if (!user) { %>
            <a href="/auth" class="menu-card">
              <div class="menu-card-icon">ğŸ”</div>
              <h3>Login / Register</h3>
              <p>Join the community</p>
            </a>
          <% } %>
        </div>
      </div>

      <% if (user && user.isAdmin) { %>
        <!-- Admin Features -->
        <div class="menu-section">
          <h2>Administration</h2>
          <div class="menu-items">
            <a href="/admin" class="menu-card admin highlight">
              <div class="menu-card-icon">ğŸ“Š</div>
              <h3>Analytics Dashboard</h3>
              <p>View platform analytics and insights</p>
            </a>

            <a href="/admin/users" class="menu-card admin highlight">
              <div class="menu-card-icon">ğŸ‘¥</div>
              <h3>User Management</h3>
              <p>Manage users and view user analytics</p>
            </a>

            <a href="/admin/assets" class="menu-card admin">
              <div class="menu-card-icon">âœ…</div>
              <h3>Asset Approvals</h3>
              <p>Approve or reject community assets</p>
            </a>

            <a href="/admin/game-state" class="menu-card admin">
              <div class="menu-card-icon">ğŸ®</div>
              <h3>Game State Controls</h3>
              <p>Configure galactic simulation parameters</p>
            </a>

            <a href="/admin/galactic-map-settings" class="menu-card admin">
              <div class="menu-card-icon">ğŸŒŒ</div>
              <h3>Galactic Map Settings</h3>
              <p>Control movement speed and grid size</p>
            </a>

            <a href="/admin/generate" class="menu-card admin">
              <div class="menu-card-icon">ğŸ”§</div>
              <h3>Generate Assets</h3>
              <p>Create system assets</p>
            </a>
          </div>
        </div>
      <% } %>
    </div>
  </main>

  <%- include('partials/footer') %>
  <script src="/javascripts/main.js"></script>
  <script>
    // Update galactic map link with character from localStorage
    document.addEventListener('DOMContentLoaded', () => {
      const selectedCharacterId = localStorage.getItem('selectedCharacterId');

      if (selectedCharacterId) {
        // Find all galactic map links and add character parameter
        const galacticMapLinks = document.querySelectorAll('a[href="/universe/galactic-map"]');
        galacticMapLinks.forEach(link => {
          link.href = `/universe/galactic-map?character=${selectedCharacterId}`;
        });

        console.log('Updated galactic map links with character:', selectedCharacterId);
      }
    });
  </script>
</body>
</html>
