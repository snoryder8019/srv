<% if (user) { %>
<!-- Active Call Overlay -->
<div id="call-overlay" style="display:none;" data-state="idle">
  <div id="call-container">
    <div id="call-header">
      <span id="call-status">[ calling... ]</span>
      <span id="call-duration"></span>
    </div>
    <!-- Dynamic peer tiles injected here by webrtc.js -->
    <div id="call-peers-grid"></div>
    <div id="call-media">
      <video id="call-local-video" autoplay playsinline muted></video>
    </div>
    <div id="call-controls">
      <button id="call-mute" type="button" title="Mute">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/>
          <path d="M19 10v2a7 7 0 0 1-14 0v-2"/>
          <line x1="12" y1="19" x2="12" y2="23"/>
          <line x1="8" y1="23" x2="16" y2="23"/>
        </svg>
      </button>
      <button id="call-video-toggle" type="button" title="Camera">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polygon points="23 7 16 12 23 17 23 7"/>
          <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
        </svg>
      </button>
      <button id="call-screen" type="button" title="Screen Share">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="2" y="3" width="20" height="14" rx="2" ry="2"/>
          <line x1="8" y1="21" x2="16" y2="21"/>
          <line x1="12" y1="17" x2="12" y2="21"/>
        </svg>
      </button>
      <button id="call-hangup" type="button" title="Hang Up" class="call-btn-danger">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2z"/>
          <line x1="1" y1="1" x2="23" y2="23"/>
        </svg>
      </button>
    </div>
  </div>
</div>

<!-- Incoming Call Modal -->
<div id="call-incoming-overlay" style="display:none;">
  <div id="call-incoming-container">
    <div id="call-incoming-header">[ incoming call ]</div>
    <div id="call-incoming-type"></div>
    <div id="call-incoming-caller"></div>
    <div id="call-incoming-actions">
      <button id="call-accept" type="button" class="call-btn-accept">Accept</button>
      <button id="call-decline" type="button" class="call-btn-danger">Decline</button>
    </div>
  </div>
</div>

<script src="/js/webrtc.js"></script>
<% } %>
