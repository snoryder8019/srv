<script>
document.addEventListener("DOMContentLoaded", () => {
  const sections = document.querySelectorAll(".section");
  const dots = document.querySelectorAll(".nav-dot");
  const container = document.querySelector(".scroll-container");

  function updateDots(activeIndex) {
    dots.forEach((dot, i) => {
      dot.classList.toggle("active", i === activeIndex);
    });
  }

  // Intersection Observer
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const idx = [...sections].indexOf(entry.target);
          updateDots(idx);
          // Retrigger fade animation
          entry.target.querySelector(".section-inner").style.animation = "none";
          requestAnimationFrame(() => {
            entry.target.querySelector(".section-inner").style.animation = "";
          });
        }
      });
    },
    { root: container, threshold: 0.6 }
  );

  sections.forEach((s) => observer.observe(s));

  // Dot click navigation
  dots.forEach((dot, i) => {
    dot.addEventListener("click", () => {
      sections[i].scrollIntoView({ behavior: "smooth" });
    });
  });

  updateDots(0);
});
</script>
